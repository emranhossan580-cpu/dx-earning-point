<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>DX Earning Point</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --bg:#0b1220;
  --card:#121a2f;
  --primary:#22c55e;
  --accent:#38bdf8;
}

*{box-sizing:border-box}
body{
  margin:0;
  font-family:Segoe UI,Arial;
  background:radial-gradient(circle at top,var(--bg),#020617);
  color:#fff;
  display:flex;
  justify-content:center;
  padding:20px;
}

.app{
  width:100%;
  max-width:420px;
  animation:fade .6s ease;
}

@keyframes fade{
  from{opacity:0;transform:translateY(20px)}
  to{opacity:1}
}

.card{
  background:linear-gradient(145deg,#111827,#020617);
  border-radius:16px;
  padding:20px;
  box-shadow:0 20px 40px rgba(0,0,0,.5);
  margin-bottom:15px;
}

h1{
  margin:0 0 5px;
  text-align:center;
  color:var(--accent);
}

.sub{
  text-align:center;
  opacity:.7;
  font-size:13px;
}

.points{
  font-size:34px;
  text-align:center;
  margin:15px 0;
  color:var(--primary);
}

.btn{
  width:100%;
  padding:13px;
  margin-top:10px;
  border:none;
  border-radius:12px;
  font-size:15px;
  font-weight:600;
  cursor:pointer;
  transition:.2s;
}

.btn:active{transform:scale(.97)}

.claim{background:var(--primary);color:#022c22}
.task{background:var(--accent);color:#020617}
.withdraw{background:#f59e0b;color:#111}

input{
  width:100%;
  padding:12px;
  margin-top:8px;
  border-radius:10px;
  border:none;
  outline:none;
}

.small{
  font-size:12px;
  opacity:.6;
  text-align:center;
  margin-top:10px;
}
</style>
</head>

<body>
<div class="app">

  <!-- USER -->
  <div class="card">
    <h1>DX Earning Point</h1>
    <div class="sub">Telegram ID: <span id="uid">Detecting...</span></div>
    <div class="points">üí∞ <span id="points">0</span></div>

    <button class="btn claim" onclick="dailyClaim()">üéÅ Daily Claim +5</button>
    <button class="btn task" onclick="openAd()">üì¢ View Ad +10</button>
  </div>

  <!-- WITHDRAW -->
  <div class="card">
    <h3>üí∏ Withdraw</h3>
    <input id="method" placeholder="Payment Method (Bkash/Nagad)" />
    <input id="number" placeholder="Your Number" />
    <input id="amount" placeholder="Points Amount" type="number" />
    <button class="btn withdraw" onclick="withdraw()">Submit Request</button>
    <div class="small">Admin manual approve system</div>
  </div>

</div>

<script>
/* ---------------- TELEGRAM USER ID ---------------- */
let tgUserId = "guest";

if(window.Telegram && Telegram.WebApp){
  Telegram.WebApp.ready();
  const user = Telegram.WebApp.initDataUnsafe?.user;
  if(user){
    tgUserId = user.id;
  }
}

document.getElementById("uid").innerText = tgUserId;

/* ---------------- POINT STORAGE ---------------- */
const key = "dx_points_" + tgUserId;
let points = parseInt(localStorage.getItem(key)) || 0;

function update(){
  document.getElementById("points").innerText = points;
  localStorage.setItem(key, points);
}
update();

/* ---------------- DAILY CLAIM ---------------- */
function dailyClaim(){
  const todayKey = "daily_" + tgUserId;
  const today = new Date().toDateString();

  if(localStorage.getItem(todayKey) === today){
    alert("‚ùå Already claimed today");
    return;
  }

  points += 5;
  localStorage.setItem(todayKey, today);
  update();
  alert("‚úÖ Daily reward added");
}

/* ---------------- AD TASK (SAFE IDEA) ---------------- */
function openAd(){
  // SAFE IDEA:
  // Adsterra Direct Link OR Link-Shortener (shrinkme / ouo)
  window.open("https://example.com","_blank");

  setTimeout(()=>{
    points += 10;
    update();
    alert("üéâ Task completed");
  },6000);
}

/* ---------------- WITHDRAW REQUEST ---------------- */
function withdraw(){
  const method = document.getElementById("method").value;
  const number = document.getElementById("number").value;
  const amount = parseInt(document.getElementById("amount").value);

  if(!method || !number || !amount){
    alert("‚ùå Fill all fields");
    return;
  }

  if(amount > points){
    alert("‚ùå Not enough points");
    return;
  }

  // SAVE REQUEST (ADMIN MANUAL CHECK)
  const list = JSON.parse(localStorage.getItem("withdraws") || "[]");
  list.push({
    uid: tgUserId,
    method,
    number,
    amount,
    time: new Date().toLocaleString()
  });

  localStorage.setItem("withdraws", JSON.stringify(list));

  points -= amount;
  update();

  alert("‚úÖ Withdraw request sent\nAdmin will review");
}
</script>
</body>
</html>
